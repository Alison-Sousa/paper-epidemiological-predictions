# Predictive and Spatial Analysis of Viral Risk in Brazil

## 1. Overview

This repository holds data and code for a broad analysis of viral risk in Brazilian municipalities. The project combines epidemiological, climate, and socioeconomic data to build predictive models, detect spatial patterns, and describe municipal risk profiles.

The method has three main steps:

â€¢ Predictive Modeling: Long Short Term Memory neural networks to forecast annual dengue risk.  
â€¢ Spatial Analysis: Spatial clusters using Moranâ€™s I and LISA.  
â€¢ Clustering: Grouping municipalities with similar risk profiles using K Means.

## 2. Repository Structure

The project is organized in these folders:

```
â”œâ”€â”€ .venv/
â”œâ”€â”€ code/
â”‚   â”œâ”€â”€ Python/
â”‚   â””â”€â”€ R/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ Python/
â”‚   â””â”€â”€ R/
â”œâ”€â”€ flow/
â””â”€â”€ results/
```

### Folder Details

ğŸ“‚ `.venv/`: Python virtual environment. Not included due to size; the author can share it on request.

ğŸ“‚ `code/`: All scripts used in the analysis.  
â€¢ `code/Python/`: Python scripts for preprocessing, LSTM training, and clustering.  
â€¢ `code/R/`: R scripts for spatial analysis and map visualization.

ğŸ“‚ `data/`: Raw and intermediate datasets.  
â€¢ `data/Python/`: Primary datasets for modeling.  
â€¢ `data/R/`: Secondary datasets generated by modeling and used in spatial analysis.

ğŸ“‚ `flow/`: Flowcharts and diagrams showing the project method.

ğŸ“‚ `results/`: Generated outputs such as tables, model metrics, and figures.

## 3. Dataset (`/data`)

#### ğŸ”¹ `/data/Python`
Primary data by municipality.

- â€¢ **`ds1.csv`**: Epidemiological data. Historical dengue cases by municipality  
  ([DATASUS Database](https://datasus.saude.gov.br/)).

- â€¢ **`ds2.csv`**: Climate and geographic data. Municipal-level variables such as temperature, precipitation, altitude, and KÃ¶ppenâ€“Geiger climate classification  
  ([KÃ¶ppen Brasil Database](https://github.com/italocegatta/koppenbrasil.github.io/blob/master/dados/munic_dados.csv)).

- â€¢ **`ds3.csv`**: Socioeconomic and infrastructure data. Indicators including GDP per capita, sanitation, solid waste collection, internet access, housing adequacy, and social progress metrics  
  ([IPS Brasil Database](https://ipsbrasil.org.br/pt/explore/dados)).

#### ğŸ”¹ `/data/R`
Outputs from the modeling phase, used in spatial analysis.

â€¢ `clu.csv`: Clustering results. Contains municipal ID (`cod6`) and assigned risk cluster from K Means.  
â€¢ `prb.csv`: Predicted probabilities. Annual high risk probabilities per municipality from the LSTM model.

## 4. Scripts (`/code`)

#### ğŸ”¹ `/code/Python`
Scripts for predictive modeling and clustering.

â€¢ `code1`: Preprocessing and modeling. Loads, cleans, and merges `ds1`, `ds2`, `ds3`. Trains the LSTM model, applies SHAP for feature selection, runs 5 fold cross validation, and generates risk probabilities.  
â€¢ `code2`: Annual and cluster analyses. Uses `code1` results to build the â€œAUC pyramidâ€ (model performance by year) and analyzes risk profiles by cluster.  
â€¢ `code3`: Risk classification. Helper script that classifies municipalities into risk bands (very low to high) based on average predicted probability and produces a quantitative summary.

#### ğŸ”¹ `/code/R`
Scripts for geospatial analysis and thematic maps.

â€¢ `clusters.R`: Maps showing the geographic distribution of risk clusters from K Means.  
â€¢ `lisa.R`: Spatial autocorrelation analysis. Computes global Moranâ€™s I and LISA to find dengue risk hotspots and coldspots.  
â€¢ `maps.R`: Choropleth maps with predicted risk level for each Brazilian municipality.  
â€¢ `panel_southeast.R`: Focus on the Southeast region, finding variables most correlated with risk in the most critical municipalities.  
â€¢ `southeast.R`: Creates detailed data files for the Southeast region analysis.  
â€¢ `southeast_maps.R`: Generates detailed risk maps for each state in the Southeast (MG, ES, RJ, SP).
